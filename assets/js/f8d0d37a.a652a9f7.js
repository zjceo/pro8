"use strict";(globalThis.webpackChunkpro_8=globalThis.webpackChunkpro_8||[]).push([[95602],{28453(e,i,n){n.d(i,{R:()=>c,x:()=>l});var a=n(96540);const r={},s=a.createContext(r);function c(e){const i=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),a.createElement(s.Provider,{value:i},e.children)}},71368(e,i,n){n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"devs/devops/Manuales-adicionales/Manipular-datos/Cambio-de-dominio","title":"Cambio de Dominio","description":"Gu\xeda completa para cambiar el dominio en una instalaci\xf3n activa con Docker.","source":"@site/docs/devs/devops/Manuales-adicionales/Manipular-datos/6-Cambio-de-dominio.md","sourceDirName":"devs/devops/Manuales-adicionales/Manipular-datos","slug":"/devs/devops/Manuales-adicionales/Manipular-datos/Cambio-de-dominio","permalink":"/devs/devops/Manuales-adicionales/Manipular-datos/Cambio-de-dominio","draft":false,"unlisted":false,"editUrl":"https://github.com/zjceo/pro8/tree/main/docs/devs/devops/Manuales-adicionales/Manipular-datos/6-Cambio-de-dominio.md","tags":[],"version":"current","lastUpdatedBy":"Administrator","lastUpdatedAt":1766975619000,"sidebarPosition":6,"frontMatter":{"title":"Cambio de Dominio","description":"Gu\xeda completa para cambiar el dominio en una instalaci\xf3n activa con Docker.","sidebar_position":6},"sidebar":"defaultSidebar","previous":{"title":"Correo electronico emisor - Cliente","permalink":"/devs/devops/Manuales-adicionales/Manipular-datos/CORREO-ELECTR\xd3NICO-EMISOR-cliente"},"next":{"title":"Eliminar Archivos Temporales en Linux","permalink":"/devs/devops/Manuales-adicionales/Manipular-datos/Eliminar-temporales"}}');var r=n(74848),s=n(28453);const c={title:"Cambio de Dominio",description:"Gu\xeda completa para cambiar el dominio en una instalaci\xf3n activa con Docker.",sidebar_position:6},l="Cambio de Dominio",o={},d=[{value:"\ud83d\udccb Pre Requisitos",id:"-pre-requisitos",level:2},{value:"Pasos para el Cambio de Dominio",id:"pasos-para-el-cambio-de-dominio",level:2},{value:"1. Conexi\xf3n al Servidor",id:"1-conexi\xf3n-al-servidor",level:3},{value:"2. Navegar a la Carpeta del Proyecto",id:"2-navegar-a-la-carpeta-del-proyecto",level:3},{value:"3. Actualizar Archivo de Configuraci\xf3n <code>.env</code>",id:"3-actualizar-archivo-de-configuraci\xf3n-env",level:3},{value:"4. Actualizar Configuraci\xf3n de Docker",id:"4-actualizar-configuraci\xf3n-de-docker",level:3},{value:"5. Reiniciar Servicios Docker",id:"5-reiniciar-servicios-docker",level:3},{value:"5.1 Detener los servicios del proyecto",id:"51-detener-los-servicios-del-proyecto",level:4},{value:"5.2 Reiniciar el proxy",id:"52-reiniciar-el-proxy",level:4},{value:"5.3 Iniciar los servicios del proyecto",id:"53-iniciar-los-servicios-del-proyecto",level:4},{value:"6. Limpiar Cach\xe9 del Sistema",id:"6-limpiar-cach\xe9-del-sistema",level:3},{value:"6.1 Listar contenedores activos",id:"61-listar-contenedores-activos",level:4},{value:"6.2 Acceder al contenedor FPM",id:"62-acceder-al-contenedor-fpm",level:4},{value:"6.3 Limpiar cach\xe9 de Laravel",id:"63-limpiar-cach\xe9-de-laravel",level:4},{value:"6.4 Salir del contenedor",id:"64-salir-del-contenedor",level:4},{value:"7. Actualizar Base de Datos (Si tiene clientes registrados)",id:"7-actualizar-base-de-datos-si-tiene-clientes-registrados",level:3},{value:"8. Configurar SSL (Si aplica)",id:"8-configurar-ssl-si-aplica",level:3},{value:"9. Verificaci\xf3n Final",id:"9-verificaci\xf3n-final",level:3},{value:"9.1 Limpiar cach\xe9 del navegador",id:"91-limpiar-cach\xe9-del-navegador",level:4},{value:"9.2 Verificar acceso",id:"92-verificar-acceso",level:4},{value:"Soluci\xf3n de Problemas",id:"soluci\xf3n-de-problemas",level:2},{value:"El sitio no carga despu\xe9s del cambio",id:"el-sitio-no-carga-despu\xe9s-del-cambio",level:3},{value:"Error 502 Bad Gateway",id:"error-502-bad-gateway",level:3},{value:"Certificado SSL no v\xe1lido",id:"certificado-ssl-no-v\xe1lido",level:3},{value:"Checklist de Verificaci\xf3n",id:"checklist-de-verificaci\xf3n",level:2}];function t(e){const i={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.header,{children:(0,r.jsx)(i.h1,{id:"cambio-de-dominio",children:"Cambio de Dominio"})}),"\n",(0,r.jsx)(i.p,{children:"Esta gu\xeda explica c\xf3mo cambiar el dominio en una instalaci\xf3n activa del sistema de facturaci\xf3n utilizando Docker."}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"-pre-requisitos",children:"\ud83d\udccb Pre Requisitos"}),"\n",(0,r.jsx)(i.p,{children:"Antes de comenzar, aseg\xfarate de tener:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Acceso SSH al servidor"}),"\n",(0,r.jsx)(i.li,{children:"Permisos de superusuario (root)"}),"\n",(0,r.jsx)(i.li,{children:"El nuevo dominio configurado y apuntando al servidor"}),"\n",(0,r.jsx)(i.li,{children:"Backup reciente de la base de datos"}),"\n"]}),"\n",(0,r.jsxs)(i.blockquote,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"\u26a0\ufe0f Importante:"})," Este proceso requiere detener temporalmente los servicios. Planifica el cambio en un horario de baja demanda."]}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"pasos-para-el-cambio-de-dominio",children:"Pasos para el Cambio de Dominio"}),"\n",(0,r.jsx)(i.h3,{id:"1-conexi\xf3n-al-servidor",children:"1. Conexi\xf3n al Servidor"}),"\n",(0,r.jsx)(i.p,{children:"Con\xe9ctese mediante SSH:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"ssh usuario@servidor\n"})}),"\n",(0,r.jsx)(i.p,{children:"Y acceda como superusuario:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"sudo su\n"})}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h3,{id:"2-navegar-a-la-carpeta-del-proyecto",children:"2. Navegar a la Carpeta del Proyecto"}),"\n",(0,r.jsx)(i.p,{children:"Acceda a la carpeta del facturador:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"cd /ruta/facturador\n"})}),"\n",(0,r.jsxs)(i.blockquote,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"\ud83d\udca1 Tip:"})," La ruta com\xfan suele ser ",(0,r.jsx)(i.code,{children:"root/{tudominio}"})]}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsxs)(i.h3,{id:"3-actualizar-archivo-de-configuraci\xf3n-env",children:["3. Actualizar Archivo de Configuraci\xf3n ",(0,r.jsx)(i.code,{children:".env"})]}),"\n",(0,r.jsx)(i.p,{children:"Edite el archivo de entorno:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"nano .env\n"})}),"\n",(0,r.jsxs)(i.p,{children:["Modifique el par\xe1metro ",(0,r.jsx)(i.code,{children:"APP_URL_BASE"})," con el nuevo dominio:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-env",children:"APP_URL_BASE=nuevoDominio.com\n"})}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.strong,{children:"Ejemplo:"})}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-env",children:"APP_URL_BASE=example.com\n"})}),"\n",(0,r.jsx)(i.p,{children:"Guardar los cambios:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["Presione ",(0,r.jsx)(i.code,{children:"Ctrl + X"})]}),"\n",(0,r.jsxs)(i.li,{children:["Presione ",(0,r.jsx)(i.code,{children:"Y"})," para confirmar"]}),"\n",(0,r.jsxs)(i.li,{children:["Presione ",(0,r.jsx)(i.code,{children:"Enter"})]}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h3,{id:"4-actualizar-configuraci\xf3n-de-docker",children:"4. Actualizar Configuraci\xf3n de Docker"}),"\n",(0,r.jsx)(i.p,{children:"Edite el archivo Docker Compose:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"nano docker-compose.yml\n"})}),"\n",(0,r.jsxs)(i.p,{children:["Busque y modifique el par\xe1metro ",(0,r.jsx)(i.code,{children:"VIRTUAL_HOST"}),":"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-yaml",children:"VIRTUAL_HOST: nuevoDominio.com, *.nuevoDominio.com\n"})}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.strong,{children:"Ejemplo:"})}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-yaml",children:"VIRTUAL_HOST: example.com, *.example.com\n"})}),"\n",(0,r.jsxs)(i.p,{children:["Guardar los cambios (",(0,r.jsx)(i.code,{children:"Ctrl + X"}),", ",(0,r.jsx)(i.code,{children:"Y"}),", ",(0,r.jsx)(i.code,{children:"Enter"}),")"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h3,{id:"5-reiniciar-servicios-docker",children:"5. Reiniciar Servicios Docker"}),"\n",(0,r.jsx)(i.h4,{id:"51-detener-los-servicios-del-proyecto",children:"5.1 Detener los servicios del proyecto"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"docker-compose down\n"})}),"\n",(0,r.jsx)(i.h4,{id:"52-reiniciar-el-proxy",children:"5.2 Reiniciar el proxy"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"docker restart proxy_proxy_1\n"})}),"\n",(0,r.jsxs)(i.blockquote,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"\u2139\ufe0f Nota:"})," El nombre del contenedor proxy puede variar. Use ",(0,r.jsx)(i.code,{children:"docker ps -a"})," para verificar el nombre exacto."]}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"53-iniciar-los-servicios-del-proyecto",children:"5.3 Iniciar los servicios del proyecto"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"docker-compose up -d\n"})}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h3,{id:"6-limpiar-cach\xe9-del-sistema",children:"6. Limpiar Cach\xe9 del Sistema"}),"\n",(0,r.jsx)(i.h4,{id:"61-listar-contenedores-activos",children:"6.1 Listar contenedores activos"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"docker ps\n"})}),"\n",(0,r.jsxs)(i.p,{children:["Identifique el contenedor ",(0,r.jsx)(i.code,{children:"fpm"})," (usualmente termina en ",(0,r.jsx)(i.code,{children:"_fpm_1"}),")"]}),"\n",(0,r.jsx)(i.h4,{id:"62-acceder-al-contenedor-fpm",children:"6.2 Acceder al contenedor FPM"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"docker exec -it [nombre_contenedor_fpm] bash\n"})}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.strong,{children:"Ejemplo:"})}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"docker exec -it facturador_fpm_1 bash\n"})}),"\n",(0,r.jsx)(i.h4,{id:"63-limpiar-cach\xe9-de-laravel",children:"6.3 Limpiar cach\xe9 de Laravel"}),"\n",(0,r.jsx)(i.p,{children:"Dentro del contenedor, ejecute:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"php artisan config:cache\r\nphp artisan cache:clear\r\nphp artisan optimize:clear\n"})}),"\n",(0,r.jsx)(i.h4,{id:"64-salir-del-contenedor",children:"6.4 Salir del contenedor"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"exit\n"})}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h3,{id:"7-actualizar-base-de-datos-si-tiene-clientes-registrados",children:"7. Actualizar Base de Datos (Si tiene clientes registrados)"}),"\n",(0,r.jsx)(i.p,{children:"Si existen clientes registrados en el sistema, debe actualizar la tabla de hostnames:"}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsx)(i.li,{children:"Acceda a la base de datos de administrador"}),"\n",(0,r.jsxs)(i.li,{children:["Localice la tabla ",(0,r.jsx)(i.code,{children:"hostnames"})]}),"\n",(0,r.jsxs)(i.li,{children:["Edite el campo ",(0,r.jsx)(i.code,{children:"fqdn"})," actualizando los dominios registrados"]}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"8-configurar-ssl-si-aplica",children:"8. Configurar SSL (Si aplica)"}),"\n",(0,r.jsx)(i.p,{children:"Si su instalaci\xf3n utiliza certificados SSL, debe actualizar los certificados para el nuevo dominio:"}),"\n",(0,r.jsxs)(i.p,{children:["\ud83d\udc49 ",(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.a,{href:"/devs/despliegue/seguridad/instalar-ssl",children:"Manual de Instalaci\xf3n/Actualizaci\xf3n SSL"})})]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h3,{id:"9-verificaci\xf3n-final",children:"9. Verificaci\xf3n Final"}),"\n",(0,r.jsx)(i.h4,{id:"91-limpiar-cach\xe9-del-navegador",children:"9.1 Limpiar cach\xe9 del navegador"}),"\n",(0,r.jsx)(i.p,{children:"En su navegador:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Chrome/Edge:"})," ",(0,r.jsx)(i.code,{children:"Ctrl + Shift + Delete"})]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Firefox:"})," ",(0,r.jsx)(i.code,{children:"Ctrl + Shift + Delete"})]}),"\n",(0,r.jsx)(i.li,{children:'Seleccione "Todo el tiempo" y limpie cach\xe9 e im\xe1genes'}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"92-verificar-acceso",children:"9.2 Verificar acceso"}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsx)(i.li,{children:"Acceda al nuevo dominio desde el navegador"}),"\n",(0,r.jsx)(i.li,{children:"Verifique que cargue correctamente"}),"\n",(0,r.jsx)(i.li,{children:"Pruebe el login y funciones principales"}),"\n",(0,r.jsx)(i.li,{children:"Revise que no haya errores en la consola del navegador"}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"soluci\xf3n-de-problemas",children:"Soluci\xf3n de Problemas"}),"\n",(0,r.jsx)(i.h3,{id:"el-sitio-no-carga-despu\xe9s-del-cambio",children:"El sitio no carga despu\xe9s del cambio"}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.strong,{children:"Posibles causas:"})}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"El dominio no est\xe1 apuntando correctamente al servidor"}),"\n",(0,r.jsx)(i.li,{children:"Los servicios Docker no se reiniciaron correctamente"}),"\n",(0,r.jsx)(i.li,{children:"Problemas con el certificado SSL"}),"\n"]}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.strong,{children:"Soluci\xf3n:"})}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"# Verificar estado de contenedores\r\ndocker ps\r\n\r\n# Revisar logs del contenedor nginx\r\ndocker logs [nombre_contenedor_nginx]\r\n\r\n# Reiniciar servicios si es necesario\r\ndocker-compose restart\n"})}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h3,{id:"error-502-bad-gateway",children:"Error 502 Bad Gateway"}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.strong,{children:"Soluci\xf3n:"})}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"# Reiniciar el proxy\r\ndocker restart proxy_proxy_1\r\n\r\n# Verificar que el contenedor FPM est\xe9 activo\r\ndocker ps | grep fpm\n"})}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h3,{id:"certificado-ssl-no-v\xe1lido",children:"Certificado SSL no v\xe1lido"}),"\n",(0,r.jsx)(i.p,{children:"Si el sitio muestra advertencia de certificado:"}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsx)(i.li,{children:"Verifique que sigui\xf3 el manual de SSL"}),"\n",(0,r.jsx)(i.li,{children:"Regenere el certificado con Let's Encrypt"}),"\n",(0,r.jsx)(i.li,{children:"Reinicie el contenedor nginx"}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"checklist-de-verificaci\xf3n",children:"Checklist de Verificaci\xf3n"}),"\n",(0,r.jsx)(i.p,{children:"Antes de dar por finalizado el cambio, verifique:"}),"\n",(0,r.jsxs)(i.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(i.li,{className:"task-list-item",children:[(0,r.jsx)(i.input,{type:"checkbox",disabled:!0})," ","El nuevo dominio carga correctamente"]}),"\n",(0,r.jsxs)(i.li,{className:"task-list-item",children:[(0,r.jsx)(i.input,{type:"checkbox",disabled:!0})," ","El login funciona sin errores"]}),"\n",(0,r.jsxs)(i.li,{className:"task-list-item",children:[(0,r.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Los certificados SSL est\xe1n activos (si aplica)"]}),"\n",(0,r.jsxs)(i.li,{className:"task-list-item",children:[(0,r.jsx)(i.input,{type:"checkbox",disabled:!0})," ","La tabla ",(0,r.jsx)(i.code,{children:"hostnames"})," fue actualizada (si hay clientes)"]}),"\n",(0,r.jsxs)(i.li,{className:"task-list-item",children:[(0,r.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Las funciones principales del sistema operan normalmente"]}),"\n",(0,r.jsxs)(i.li,{className:"task-list-item",children:[(0,r.jsx)(i.input,{type:"checkbox",disabled:!0})," ","No hay errores en los logs de Docker"]}),"\n",(0,r.jsxs)(i.li,{className:"task-list-item",children:[(0,r.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Los clientes pueden acceder a sus subdominios (si aplica)"]}),"\n"]}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.em,{children:"Sistema de Facturaci\xf3n Pro 8"})})]})}function h(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}}}]);